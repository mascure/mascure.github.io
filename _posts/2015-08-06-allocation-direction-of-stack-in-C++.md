---
layout: post
title:  "allocation direction of stack in C++"
date:   2015-08-06 13:17:58
categories: jekyll update
---
我们知道c++中的两种分配内存方式，栈内存，堆内存。其中栈内存由高地址向低地址分配，堆内存由低地址向高地址分配。因此，在一个函数中，我们先后声明两个变量，这两个变量都在栈中分配内存，因此后一个变量地址要小于前一个地址。
{% highlight c++%}
int a,b;
{% endhighlight %}
但我们声明一个数组，比如
{% highlight c++%}
int x[2];
cout<<x<<","<<x+1<<endl;
{% endhighlight %}
x[0]和x[1]在内存里面，哪个在前，哪个在后呢？可以看到x+1的值要大于x，也就是x[1]的地址大，x[0]的地址小。
也就是说，分配一个数组的空间时，系统计算好总大小，分配好这段内存，然后按照地址从小到大的方向依次放置数组元素。元素放置的方向与栈内存的分配方向相反。如图
{% highlight c++%}
高地址
      .
      .
      .
    x[1]
    x[0]
      .
      .
      .
低地址
{% endhighlight %}
个人认为这是为了保证程序员可以不加区别的使用数组下标相减的操作。
